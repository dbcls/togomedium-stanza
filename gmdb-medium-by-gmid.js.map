{"version":3,"file":"gmdb-medium-by-gmid.js","sources":["../../../home/runner/work/togomedium-stanza/togomedium-stanza/stanzas/gmdb-medium-by-gmid/index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.__TEST__ = void 0;\nconst get_data_1 = require(\"../../utils/get-data\");\nconst variables_1 = require(\"../../utils/variables\");\nconst stanza_1 = require(\"../../utils/stanza\");\nasync function gmdbMediumByGmid(stanza, params) {\n    if (!params.gm_id) {\n        return;\n    }\n    const apiName = \"gmdb_medium_by_gmid\";\n    const result = await get_data_1.getData(`${variables_1.API_GROWTH_MEDIUM}${apiName}`, {\n        gm_id: params.gm_id,\n    });\n    const data = parseData(result, params);\n    stanza.render({\n        template: \"stanza.html.hbs\",\n        parameters: data,\n    });\n    stanza_1.importWebFontForTogoMedium(stanza);\n}\nexports.default = gmdbMediumByGmid;\nconst parseData = (data, params) => {\n    switch (true) {\n        case data.status !== 200:\n            return makeErrorData(`Error ${data.status}<br />${data.message}`);\n        case data.body.meta === null:\n            return makeErrorData(`Error 404<br />No Media Found with ${params.gm_id}`);\n        default:\n            return makeSuccessData(data.body);\n    }\n};\nconst makeErrorData = (msg) => {\n    return {\n        id: null,\n        name: null,\n        src_url: null,\n        src_label: null,\n        ph: null,\n        components: [],\n        error: true,\n        statusText: msg,\n    };\n};\nconst makeSuccessData = (body) => {\n    return {\n        id: body.meta.gm.split(\"/\").pop(),\n        name: body.meta.name,\n        src_label: getSrcLabel(body.meta.src_url),\n        src_url: body.meta.src_url,\n        ph: body.meta.ph,\n        components: [\n            ...processComponentTables(body.components),\n            ...processComponentComments(body.comments),\n        ].sort((a, b) => a.paragraph_index - b.paragraph_index),\n    };\n};\nconst processComponentTables = (tables) => {\n    return tables.map((table) => ({\n        ...table,\n        items: table.items.map((item) => {\n            var _a, _b;\n            return ({\n                ...item,\n                can_wrap_label: ((_a = item.label) === null || _a === void 0 ? void 0 : _a.length) >= 20,\n                can_wrap_name: ((_b = item.component_name) === null || _b === void 0 ? void 0 : _b.length) >= 20,\n                properties: item.properties.map((property) => ({\n                    ...property,\n                    displayLabel: getShortPropertyLabel(property.label),\n                })),\n            });\n        }),\n    }));\n};\nconst processComponentComments = (comments) => {\n    return comments.map((item) => ({\n        ...item,\n        comment: item.comment ? item.comment : \"&nbsp;\",\n    }));\n};\nfunction getShortPropertyLabel(str) {\n    const dic = {\n        \"Simple component\": \"Simple\",\n        \"Complex component\": \"Complex\",\n        \"Defined component\": \"Defined\",\n        \"Undefined component\": \"Undefined\",\n        \"Inorganic compound\": \"Inorganic\",\n        \"Organic compound\": \"Organic\",\n        Solution: \"Solution\",\n    };\n    if (!dic[str]) {\n        console.warn(\"no short property label found:\", str);\n    }\n    return dic[str] ? dic[str] : \"ERR\";\n}\nconst getSrcLabel = (str) => {\n    switch (true) {\n        case str.match(/jcm.*riken/) !== null:\n            return \"JCM\";\n        case str.match(/nite.*nbrc/) !== null:\n            return \"NBRC\";\n        case str.match(/dsmz\\.de/) !== null:\n            return \"DSMZ\";\n        case str.match(/atcc\\.org/) !== null:\n            return \"ATCC\";\n        default:\n            return \"SRC\";\n    }\n};\nexports.__TEST__ = { getSrcLabel };\n//# sourceMappingURL=index.js.map"],"names":["stanza","get_data_1","variables_1","stanza_1"],"mappings":";;;;;;AACA,MAAM,CAAC,cAAc,UAAU,YAAY,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;AAC9D,mBAAmB,KAAK,CAAC,CAAC;AACyB;AACE;AACN;AAC/C,eAAe,gBAAgB,CAACA,QAAM,EAAE,MAAM,EAAE;AAChD,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;AACvB,QAAQ,OAAO;AACf,KAAK;AACL,IAAI,MAAM,OAAO,GAAG,qBAAqB,CAAC;AAC1C,IAAI,MAAM,MAAM,GAAG,MAAMC,SAAU,CAAC,OAAO,CAAC,CAAC,EAAEC,SAAW,CAAC,iBAAiB,CAAC,EAAE,OAAO,CAAC,CAAC,EAAE;AAC1F,QAAQ,KAAK,EAAE,MAAM,CAAC,KAAK;AAC3B,KAAK,CAAC,CAAC;AACP,IAAI,MAAM,IAAI,GAAG,SAAS,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;AAC3C,IAAIF,QAAM,CAAC,MAAM,CAAC;AAClB,QAAQ,QAAQ,EAAE,iBAAiB;AACnC,QAAQ,UAAU,EAAE,IAAI;AACxB,KAAK,CAAC,CAAC;AACP,IAAIG,MAAQ,CAAC,0BAA0B,CAACH,QAAM,CAAC,CAAC;AAChD,CAAC;AACD,kBAAkB,gBAAgB,CAAC;AACnC,MAAM,SAAS,GAAG,CAAC,IAAI,EAAE,MAAM,KAAK;AACpC,IAAI,QAAQ,IAAI;AAChB,QAAQ,KAAK,IAAI,CAAC,MAAM,KAAK,GAAG;AAChC,YAAY,OAAO,aAAa,CAAC,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;AAC9E,QAAQ,KAAK,IAAI,CAAC,IAAI,CAAC,IAAI,KAAK,IAAI;AACpC,YAAY,OAAO,aAAa,CAAC,CAAC,mCAAmC,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;AACvF,QAAQ;AACR,YAAY,OAAO,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAC9C,KAAK;AACL,CAAC,CAAC;AACF,MAAM,aAAa,GAAG,CAAC,GAAG,KAAK;AAC/B,IAAI,OAAO;AACX,QAAQ,EAAE,EAAE,IAAI;AAChB,QAAQ,IAAI,EAAE,IAAI;AAClB,QAAQ,OAAO,EAAE,IAAI;AACrB,QAAQ,SAAS,EAAE,IAAI;AACvB,QAAQ,EAAE,EAAE,IAAI;AAChB,QAAQ,UAAU,EAAE,EAAE;AACtB,QAAQ,KAAK,EAAE,IAAI;AACnB,QAAQ,UAAU,EAAE,GAAG;AACvB,KAAK,CAAC;AACN,CAAC,CAAC;AACF,MAAM,eAAe,GAAG,CAAC,IAAI,KAAK;AAClC,IAAI,OAAO;AACX,QAAQ,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE;AACzC,QAAQ,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,IAAI;AAC5B,QAAQ,SAAS,EAAE,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;AACjD,QAAQ,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO;AAClC,QAAQ,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE;AACxB,QAAQ,UAAU,EAAE;AACpB,YAAY,GAAG,sBAAsB,CAAC,IAAI,CAAC,UAAU,CAAC;AACtD,YAAY,GAAG,wBAAwB,CAAC,IAAI,CAAC,QAAQ,CAAC;AACtD,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,eAAe,GAAG,CAAC,CAAC,eAAe,CAAC;AAC/D,KAAK,CAAC;AACN,CAAC,CAAC;AACF,MAAM,sBAAsB,GAAG,CAAC,MAAM,KAAK;AAC3C,IAAI,OAAO,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,MAAM;AAClC,QAAQ,GAAG,KAAK;AAChB,QAAQ,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,KAAK;AACzC,YAAY,IAAI,EAAE,EAAE,EAAE,CAAC;AACvB,YAAY,QAAQ;AACpB,gBAAgB,GAAG,IAAI;AACvB,gBAAgB,cAAc,EAAE,CAAC,CAAC,EAAE,GAAG,IAAI,CAAC,KAAK,MAAM,IAAI,IAAI,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,MAAM,KAAK,EAAE;AACxG,gBAAgB,aAAa,EAAE,CAAC,CAAC,EAAE,GAAG,IAAI,CAAC,cAAc,MAAM,IAAI,IAAI,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,EAAE,CAAC,MAAM,KAAK,EAAE;AAChH,gBAAgB,UAAU,EAAE,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,QAAQ,MAAM;AAC/D,oBAAoB,GAAG,QAAQ;AAC/B,oBAAoB,YAAY,EAAE,qBAAqB,CAAC,QAAQ,CAAC,KAAK,CAAC;AACvE,iBAAiB,CAAC,CAAC;AACnB,aAAa,EAAE;AACf,SAAS,CAAC;AACV,KAAK,CAAC,CAAC,CAAC;AACR,CAAC,CAAC;AACF,MAAM,wBAAwB,GAAG,CAAC,QAAQ,KAAK;AAC/C,IAAI,OAAO,QAAQ,CAAC,GAAG,CAAC,CAAC,IAAI,MAAM;AACnC,QAAQ,GAAG,IAAI;AACf,QAAQ,OAAO,EAAE,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,GAAG,QAAQ;AACvD,KAAK,CAAC,CAAC,CAAC;AACR,CAAC,CAAC;AACF,SAAS,qBAAqB,CAAC,GAAG,EAAE;AACpC,IAAI,MAAM,GAAG,GAAG;AAChB,QAAQ,kBAAkB,EAAE,QAAQ;AACpC,QAAQ,mBAAmB,EAAE,SAAS;AACtC,QAAQ,mBAAmB,EAAE,SAAS;AACtC,QAAQ,qBAAqB,EAAE,WAAW;AAC1C,QAAQ,oBAAoB,EAAE,WAAW;AACzC,QAAQ,kBAAkB,EAAE,SAAS;AACrC,QAAQ,QAAQ,EAAE,UAAU;AAC5B,KAAK,CAAC;AACN,IAAI,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;AACnB,QAAQ,OAAO,CAAC,IAAI,CAAC,gCAAgC,EAAE,GAAG,CAAC,CAAC;AAC5D,KAAK;AACL,IAAI,OAAO,GAAG,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;AACvC,CAAC;AACD,MAAM,WAAW,GAAG,CAAC,GAAG,KAAK;AAC7B,IAAI,QAAQ,IAAI;AAChB,QAAQ,KAAK,GAAG,CAAC,KAAK,CAAC,YAAY,CAAC,KAAK,IAAI;AAC7C,YAAY,OAAO,KAAK,CAAC;AACzB,QAAQ,KAAK,GAAG,CAAC,KAAK,CAAC,YAAY,CAAC,KAAK,IAAI;AAC7C,YAAY,OAAO,MAAM,CAAC;AAC1B,QAAQ,KAAK,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,KAAK,IAAI;AAC3C,YAAY,OAAO,MAAM,CAAC;AAC1B,QAAQ,KAAK,GAAG,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,IAAI;AAC5C,YAAY,OAAO,MAAM,CAAC;AAC1B,QAAQ;AACR,YAAY,OAAO,KAAK,CAAC;AACzB,KAAK;AACL,CAAC,CAAC;AACF,mBAAmB,EAAE,WAAW,EAAE,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}